(()=>{var __webpack_modules__={"./src/js/effects/universe.js":()=>{eval("/**\r\n * created by lvfan\r\n * 2018-09-04\r\n */\r\n(function drawBg() {\r\n  window.requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame ||\r\n        window.webkitRequestAnimationFrame || window.msRequestAnimationFrame\r\n  // const\r\n  const starDensity = 0.216\r\n  const speedCoeff = 0.05\r\n  const mode = DreamConfig.effects_universe_mode\r\n  const canvas = document.createElement('canvas')\r\n\r\n  // let\r\n  let width\r\n  let height\r\n  let starCount\r\n  /* no-unused-vars */\r\n  // let circleRadius;\r\n  // let circleCenter;\r\n  let first = true\r\n  const giantColor = '180,184,240'\r\n  const starColor = '226,225,142'\r\n  const cometColor = '226,225,224'\r\n  const stars = []\r\n  let universe\r\n\r\n  windowResizeHandler()\r\n  window.addEventListener('resize', windowResizeHandler, false)\r\n\r\n  function windowResizeHandler() {\r\n    width = window.innerWidth\r\n    height = window.innerHeight\r\n    starCount = width * starDensity\r\n    // circleRadius = (width > height ? height / 2 : width / 2);\r\n    // circleCenter = {\r\n    //   x: width / 2,\r\n    //   y: height / 2\r\n    // };\r\n    canvas.setAttribute('width', width)\r\n    canvas.setAttribute('height', height)\r\n    canvas.setAttribute('class', `canvas_effects ${mode}`)\r\n    document.body.insertBefore(canvas, document.body.firstChild)\r\n  }\r\n\r\n  createUniverse()\r\n\r\n  function createUniverse() {\r\n    universe = canvas.getContext('2d')\r\n    for (var i = 0; i < starCount; i++) {\r\n      stars[i] = new Star()\r\n      stars[i].reset()\r\n    }\r\n    draw()\r\n  }\r\n\r\n  function draw() {\r\n    universe.clearRect(0, 0, width, height)\r\n    var starsLength = stars.length\r\n    for (var i = 0; i < starsLength; i++) {\r\n      var star = stars[i]\r\n      star.move()\r\n      star.fadeIn()\r\n      star.fadeOut()\r\n      star.draw()\r\n    }\r\n  }\r\n\r\n  function Star() {\r\n    this.reset = function () {\r\n      this.giant = getProbability(3)\r\n      this.comet = this.giant || first ? false : getProbability(10)\r\n      this.x = getRandInterval(0, width - 10)\r\n      this.y = getRandInterval(0, height)\r\n      this.r = getRandInterval(1.1, 2.6)\r\n      this.dx = getRandInterval(speedCoeff, 6 * speedCoeff) + (this.comet + 1 - 1) * speedCoeff * getRandInterval(50, 120) + speedCoeff * 2\r\n      this.dy = -getRandInterval(speedCoeff, 6 * speedCoeff) - (this.comet + 1 - 1) * speedCoeff * getRandInterval(50, 120)\r\n      this.fadingOut = null\r\n      this.fadingIn = true\r\n      this.opacity = 0\r\n      this.opacityTresh = getRandInterval(0.2, 1 - (this.comet + 1 - 1) * 0.4)\r\n      this.do = getRandInterval(0.0005, 0.002) + (this.comet + 1 - 1) * 0.001\r\n    }\r\n    this.fadeIn = function () {\r\n      if (this.fadingIn) {\r\n        this.fadingIn = !(this.opacity > this.opacityTresh)\r\n        this.opacity += this.do\r\n      }\r\n    }\r\n    this.fadeOut = function () {\r\n      if (this.fadingOut) {\r\n        this.fadingOut = !(this.opacity < 0)\r\n        this.opacity -= this.do / 2\r\n        if (this.x > width || this.y < 0) {\r\n          this.fadingOut = false\r\n          this.reset()\r\n        }\r\n      }\r\n    }\r\n    this.draw = function () {\r\n      universe.beginPath()\r\n      if (this.giant) {\r\n        universe.fillStyle = 'rgba(' + giantColor + ',' + this.opacity + ')'\r\n        universe.arc(this.x, this.y, 2, 0, 2 * Math.PI, false)\r\n      } else if (this.comet) {\r\n        universe.fillStyle = 'rgba(' + cometColor + ',' + this.opacity + ')'\r\n        universe.arc(this.x, this.y, 1.5, 0, 2 * Math.PI, false)\r\n        // comet tail\r\n        for (var i = 0; i < 30; i++) {\r\n          universe.fillStyle = 'rgba(' + cometColor + ',' + (this.opacity - (this.opacity / 20) * i) + ')'\r\n          universe.rect(this.x - this.dx / 4 * i, this.y - this.dy / 4 * i - 2, 2, 2)\r\n          universe.fill()\r\n        }\r\n      } else {\r\n        universe.fillStyle = 'rgba(' + starColor + ',' + this.opacity + ')'\r\n        universe.rect(this.x, this.y, this.r, this.r)\r\n      }\r\n      universe.closePath()\r\n      universe.fill()\r\n    }\r\n    this.move = function () {\r\n      this.x += this.dx\r\n      this.y += this.dy\r\n      if (this.fadingOut === false) {\r\n        this.reset()\r\n      }\r\n      if (this.x > width - (width / 4) || this.y < 0) {\r\n        this.fadingOut = true\r\n      }\r\n    };\r\n    (function () {\r\n      setTimeout(function () {\r\n        first = false\r\n      }, 50)\r\n    })()\r\n  }\r\n\r\n  function getProbability(percents) {\r\n    return ((Math.floor(Math.random() * 1000) + 1) < percents * 10)\r\n  }\r\n\r\n  function getRandInterval(min, max) {\r\n    return (Math.random() * (max - min) + min)\r\n  }\r\n\r\n  (function drawIfNeeded() {\r\n    const isNight = document.documentElement.classList.contains('night')\r\n    if (canvas.classList.contains('all') || (canvas.classList.contains('day') && !isNight) || (canvas.classList.contains('night') && isNight)) {\r\n      draw()\r\n    }\r\n    window.requestAnimationFrame(drawIfNeeded)\r\n  })()\r\n}())\n\n//# sourceURL=webpack://halo-theme-dream2.0-plus/./src/js/effects/universe.js?")}},__webpack_exports__={};__webpack_modules__["./src/js/effects/universe.js"]()})();