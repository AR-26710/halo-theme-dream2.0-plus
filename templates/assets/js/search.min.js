$(function(){var e,t=document.getElementById("dream-search-form"),r=DreamConfig.search_target,n=document.getElementById("halo-search-form-text-input"),c=$("#dream-search-result"),s=$("#dream-search-result-empty");function o(e){return e.replace(/<(?!\/?mark\b)[^>]*>/g,"")}function a(e){if(!e)return c.empty(),s.show();Utils.request({url:"/apis/api.halo.run/v1alpha1/indices/post",contentType:"application/json;charset=UTF-8",returnRaw:!0,data:{keyword:e,limit:$("#halo-search-form-limit").val(),highlightPreTag:"<mark>",highlightPostTag:"</mark>"}}).then(e=>{if(0<e.hits.length){s.hide(),c.empty();for(var t=0;t<e.hits.length;t++)try{var n=e.hits[t],a=o(n.title),i=n.content?o(n.content):"";c.append('<div class="widget card search">\n<div class="card-content main">\n<a href="'+n.permalink+'"  target="'+r+'">\n<h2 class="title">'+a+"</h2>\n</a>\n"+(i?'<div class="main-content not-toc description">\n'+i+"\n</div>\n":"")+'<hr/>\n<div class="meta">\n<div></div>\n<em text="最后更新于 '+Utils.formatDate(n.updateTimestamp,"yyyy年MM月dd日 HH:mm:ss")+'"></em>\n</div>\n</div>\n')}catch(e){}}else s.show(),c.empty()}).catch(e=>{})}t.addEventListener("submit",function(e){e.preventDefault(),a(n.value)}),document.addEventListener("keydown",function(e){"Enter"===e.key&&t.contains(document.activeElement)&&(e.preventDefault(),a(n.value))}),n.addEventListener("input",function(e){a(e.target.value)}),function(e,t=window.location.href){e="keyword".replace(/[\[\]]/g,"\\$&");e=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return e&&e[2]&&decodeURIComponent(e[2].replace(/\+/g," "))}()&&(e=new Event("input",{bubbles:!0}),n.dispatchEvent(e))});